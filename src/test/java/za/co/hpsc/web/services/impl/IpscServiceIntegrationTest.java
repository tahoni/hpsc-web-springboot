package za.co.hpsc.web.services.impl;

import org.junit.jupiter.api.Test;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.context.annotation.Bean;
import org.springframework.test.context.ActiveProfiles;
import org.springframework.transaction.PlatformTransactionManager;
import za.co.hpsc.web.models.ipsc.records.IpscMatchRecord;
import za.co.hpsc.web.models.ipsc.records.IpscMatchRecordHolder;
import za.co.hpsc.web.repositories.*;
import za.co.hpsc.web.services.*;

import static org.junit.jupiter.api.Assertions.*;

// TODO: finish this
@ActiveProfiles("test")
@SpringBootTest
public class IpscServiceIntegrationTest {
    @Autowired
    private PlatformTransactionManager platformTransactionManager;

    @Autowired
    private CompetitorRepository competitorRepository;

    @Autowired
    private IpscService ipscService;

    @Bean
    public IpscService winMssService(IpscMatchService ipscMatchService,
                                     IpscMatchResultService ipscMatchResultService,
                                     TransactionService transactionService) {
        return new IpscServiceImpl(ipscMatchService, ipscMatchResultService, transactionService);
    }

    @Bean
    public IpscMatchService ipscMatchService(TransactionService transactionService) {
        return new IpscMatchServiceImpl(transactionService);
    }

    @Bean
    public TransactionService transactionService(IpscDomainService ipscDomainService,
                                                 ClubRepository clubRepository,
                                                 IpscMatchRepository ipscMatchRepository,
                                                 IpscMatchStageRepository ipscMatchStageRepository,
                                                 MatchCompetitorRepository matchCompetitorRepository,
                                                 MatchStageCompetitorRepository matchStageCompetitorRepository) {
        return new TransactionServiceImpl(platformTransactionManager, ipscDomainService, clubRepository,
                competitorRepository, ipscMatchRepository, ipscMatchStageRepository,
                matchCompetitorRepository, matchStageCompetitorRepository);
    }

    @Test
    public void testImportWinMssCabFile() {
        String cabFileContent = """
                {
                    "club": "<xml xmlns:s='uuid:BDC6E3F0-6DA3-11d1-A2A3-00AA00C14882' xmlns:dt='uuid:C2F41010-65B3-11d1-A29F-00AA00C14882' xmlns:rs='urn:schemas-microsoft-com:rowset' xmlns:z='#RowsetSchema'><s:Schema id='RowsetSchema'><s:ElementType name='row' content='eltOnly' rs:updatable='true'><s:AttributeType name='ClubId' rs:number='1' rs:nullable='true' rs:maydefer='true' rs:writeunknown='true' rs:basetable='tblMatch' rs:basecolumn='ClubId'><s:datatype dt:type='i2' dt:maxLength='2' rs:precision='5' rs:fixedlength='true'/></s:AttributeType><s:AttributeType name='ClubCode' rs:number='2' rs:nullable='true' rs:maydefer='true' rs:writeunknown='true' rs:basetable='tblClub' rs:basecolumn='ClubCode'><s:datatype dt:type='string' dt:maxLength='6'/></s:AttributeType><s:AttributeType name='Club' rs:number='3' rs:nullable='true' rs:maydefer='true' rs:writeunknown='true' rs:basetable='tblClub' rs:basecolumn='Club' rs:keycolumn='true'><s:datatype dt:type='string' dt:maxLength='50'/></s:AttributeType><s:AttributeType name='Contact' rs:number='4' rs:nullable='true' rs:maydefer='true' rs:writeunknown='true' rs:basetable='tblClub' rs:basecolumn='Contact'><s:datatype dt:type='string' dt:maxLength='50'/></s:AttributeType><s:AttributeType name='Address1' rs:number='5' rs:nullable='true' rs:maydefer='true' rs:writeunknown='true' rs:basetable='tblClub' rs:basecolumn='Address1'><s:datatype dt:type='string' dt:maxLength='40'/></s:AttributeType><s:AttributeType name='Address2' rs:number='6' rs:nullable='true' rs:maydefer='true' rs:writeunknown='true' rs:basetable='tblClub' rs:basecolumn='Address2'><s:datatype dt:type='string' dt:maxLength='40'/></s:AttributeType><s:AttributeType name='City' rs:number='7' rs:nullable='true' rs:maydefer='true' rs:writeunknown='true' rs:basetable='tblClub' rs:basecolumn='City'><s:datatype dt:type='string' dt:maxLength='20'/></s:AttributeType><s:AttributeType name='Province' rs:number='8' rs:nullable='true' rs:maydefer='true' rs:writeunknown='true' rs:basetable='tblClub' rs:basecolumn='Province'><s:datatype dt:type='string' dt:maxLength='24'/></s:AttributeType><s:AttributeType name='CountryId' rs:number='9' rs:nullable='true' rs:maydefer='true' rs:writeunknown='true' rs:basetable='tblClub' rs:basecolumn='TypeCountryId'><s:datatype dt:type='string' dt:maxLength='3'/></s:AttributeType><s:AttributeType name='PostCode' rs:number='10' rs:nullable='true' rs:maydefer='true' rs:writeunknown='true' rs:basetable='tblClub' rs:basecolumn='PostCode'><s:datatype dt:type='string' dt:maxLength='10'/></s:AttributeType><s:AttributeType name='Phone' rs:number='11' rs:nullable='true' rs:maydefer='true' rs:writeunknown='true' rs:basetable='tblClub' rs:basecolumn='Phone'><s:datatype dt:type='string' dt:maxLength='20'/></s:AttributeType><s:AttributeType name='PhoneAlt' rs:number='12' rs:nullable='true' rs:maydefer='true' rs:writeunknown='true' rs:basetable='tblClub' rs:basecolumn='PhoneAlternate'><s:datatype dt:type='string' dt:maxLength='20'/></s:AttributeType><s:AttributeType name='PhoneFax' rs:number='13' rs:nullable='true' rs:maydefer='true' rs:writeunknown='true' rs:basetable='tblClub' rs:basecolumn='PhoneFax'><s:datatype dt:type='string' dt:maxLength='20'/></s:AttributeType><s:AttributeType name='Email' rs:number='14' rs:nullable='true' rs:maydefer='true' rs:writeunknown='true' rs:basetable='tblClub' rs:basecolumn='Email'><s:datatype dt:type='string' dt:maxLength='36'/></s:AttributeType><s:AttributeType name='WebSite' rs:number='15' rs:nullable='true' rs:maydefer='true' rs:writeunknown='true' rs:basetable='tblClub' rs:basecolumn='WebSite'><s:datatype dt:type='string' dt:maxLength='64'/></s:AttributeType><s:extends type='rs:rowbase'/></s:ElementType></s:Schema><rs:data/></xml>",
                    "match": "<xml xmlns:s='uuid:BDC6E3F0-6DA3-11d1-A2A3-00AA00C14882' xmlns:dt='uuid:C2F41010-65B3-11d1-A29F-00AA00C14882' xmlns:rs='urn:schemas-microsoft-com:rowset' xmlns:z='#RowsetSchema'><s:Schema id='RowsetSchema'><s:ElementType name='row' content='eltOnly' rs:updatable='true'><s:AttributeType name='MatchId' rs:number='1' rs:maydefer='true' rs:writeunknown='true' rs:basetable='tblMatch' rs:basecolumn='MatchId' rs:keycolumn='true' rs:autoincrement='true'><s:datatype dt:type='int' dt:maxLength='4' rs:precision='10' rs:fixedlength='true'/></s:AttributeType><s:AttributeType name='MatchName' rs:number='2' rs:nullable='true' rs:maydefer='true' rs:writeunknown='true' rs:basetable='tblMatch' rs:basecolumn='MatchName'><s:datatype dt:type='string' dt:maxLength='50'/></s:AttributeType><s:AttributeType name='MatchDt' rs:number='3' rs:nullable='true' rs:maydefer='true' rs:writeunknown='true' rs:basetable='tblMatch' rs:basecolumn='MatchDt'><s:datatype dt:type='dateTime' rs:dbtype='variantdate' dt:maxLength='16' rs:fixedlength='true'/></s:AttributeType><s:AttributeType name='ClubId' rs:number='4' rs:nullable='true' rs:maydefer='true' rs:writeunknown='true' rs:basetable='tblMatch' rs:basecolumn='ClubId'><s:datatype dt:type='i2' dt:maxLength='2' rs:precision='5' rs:fixedlength='true'/></s:AttributeType><s:AttributeType name='Chrono' rs:number='5' rs:maydefer='true' rs:writeunknown='true' rs:basetable='tblMatch' rs:basecolumn='Chronograph'><s:datatype dt:type='boolean' dt:maxLength='2' rs:fixedlength='true'/></s:AttributeType><s:AttributeType name='MatchLevel' rs:number='6' rs:nullable='true' rs:maydefer='true' rs:writeunknown='true' rs:basetable='tblMatch' rs:basecolumn='TypeMatchLevel'><s:datatype dt:type='ui1' dt:maxLength='1' rs:precision='3' rs:fixedlength='true'/></s:AttributeType><s:AttributeType name='CountryId' rs:number='7' rs:nullable='true' rs:maydefer='true' rs:writeunknown='true' rs:basetable='tblMatch' rs:basecolumn='TypeCountryId'><s:datatype dt:type='string' dt:maxLength='3'/></s:AttributeType><s:AttributeType name='FirearmId' rs:number='8' rs:nullable='true' rs:maydefer='true' rs:writeunknown='true' rs:basetable='tblMatch' rs:basecolumn='TypeFirearmId'><s:datatype dt:type='ui1' dt:maxLength='1' rs:precision='3' rs:fixedlength='true'/></s:AttributeType><s:AttributeType name='SquadCount' rs:number='9' rs:nullable='true' rs:maydefer='true' rs:writeunknown='true' rs:basetable='tblMatch' rs:basecolumn='SquadCount'><s:datatype dt:type='ui1' dt:maxLength='1' rs:precision='3' rs:fixedlength='true'/></s:AttributeType><s:AttributeType name='MD' rs:number='10' rs:nullable='true' rs:maydefer='true' rs:writeunknown='true' rs:basetable='tblMatch' rs:basecolumn='MatchDirector'><s:datatype dt:type='string' dt:maxLength='40'/></s:AttributeType><s:AttributeType name='RM' rs:number='11' rs:nullable='true' rs:maydefer='true' rs:writeunknown='true' rs:basetable='tblMatch' rs:basecolumn='RangeMaster'><s:datatype dt:type='string' dt:maxLength='40'/></s:AttributeType><s:AttributeType name='SD' rs:number='12' rs:nullable='true' rs:maydefer='true' rs:writeunknown='true' rs:basetable='tblMatch' rs:basecolumn='StatsDirector'><s:datatype dt:type='string' dt:maxLength='40'/></s:AttributeType><s:extends type='rs:rowbase'/></s:ElementType></s:Schema><rs:data><z:row MatchId='1' MatchName='Eeufees HG and PCC Club Shoot February 2026' MatchDt='2026-02-07T00:00:00' Chrono='False' MatchLevel='1' CountryId='CAN' FirearmId='7' SquadCount='9'/></rs:data></xml>",
                    "stage": "<xml xmlns:s='uuid:BDC6E3F0-6DA3-11d1-A2A3-00AA00C14882' xmlns:dt='uuid:C2F41010-65B3-11d1-A29F-00AA00C14882' xmlns:rs='urn:schemas-microsoft-com:rowset' xmlns:z='#RowsetSchema'><s:Schema id='RowsetSchema'><s:ElementType name='row' content='eltOnly' rs:updatable='true'><s:AttributeType name='MatchId' rs:number='1' rs:nullable='true' rs:maydefer='true' rs:writeunknown='true' rs:basetable='tblMatchStage' rs:basecolumn='MatchId' rs:keycolumn='true'><s:datatype dt:type='int' dt:maxLength='4' rs:precision='10' rs:fixedlength='true'/></s:AttributeType><s:AttributeType name='StageId' rs:number='2' rs:nullable='true' rs:maydefer='true' rs:writeunknown='true' rs:basetable='tblMatchStage' rs:basecolumn='StageId' rs:keycolumn='true'><s:datatype dt:type='ui1' dt:maxLength='1' rs:precision='3' rs:fixedlength='true'/></s:AttributeType><s:AttributeType name='StageName' rs:number='3' rs:nullable='true' rs:maydefer='true' rs:writeunknown='true' rs:basetable='tblMatchStage' rs:basecolumn='StageName'><s:datatype dt:type='string' dt:maxLength='32'/></s:AttributeType><s:AttributeType name='Location' rs:number='4' rs:nullable='true' rs:maydefer='true' rs:writeunknown='true' rs:basetable='tblMatchStage' rs:basecolumn='Location'><s:datatype dt:type='string' dt:maxLength='32'/></s:AttributeType><s:AttributeType name='FirearmId' rs:number='5' rs:nullable='true' rs:maydefer='true' rs:writeunknown='true' rs:basetable='tblMatchStage' rs:basecolumn='TypeFirearmId'><s:datatype dt:type='ui1' dt:maxLength='1' rs:precision='3' rs:fixedlength='true'/></s:AttributeType><s:AttributeType name='CourseId' rs:number='6' rs:nullable='true' rs:maydefer='true' rs:writeunknown='true' rs:basetable='tblMatchStage' rs:basecolumn='TypeStageCourseId'><s:datatype dt:type='ui1' dt:maxLength='1' rs:precision='3' rs:fixedlength='true'/></s:AttributeType><s:AttributeType name='ScoringId' rs:number='7' rs:nullable='true' rs:maydefer='true' rs:writeunknown='true' rs:basetable='tblMatchStage' rs:basecolumn='TypeScoringId'><s:datatype dt:type='ui1' dt:maxLength='1' rs:precision='3' rs:fixedlength='true'/></s:AttributeType><s:AttributeType name='TrgtTypeId' rs:number='8' rs:nullable='true' rs:maydefer='true' rs:writeunknown='true' rs:basetable='tblMatchStage' rs:basecolumn='TypeTargetClassifyId'><s:datatype dt:type='ui1' dt:maxLength='1' rs:precision='3' rs:fixedlength='true'/></s:AttributeType><s:AttributeType name='IcsStageId' rs:number='9' rs:nullable='true' rs:maydefer='true' rs:writeunknown='true' rs:basetable='tblMatchStage' rs:basecolumn='TypeStdStageSetupId'><s:datatype dt:type='i2' dt:maxLength='2' rs:precision='5' rs:fixedlength='true'/></s:AttributeType><s:AttributeType name='Remove' rs:number='10' rs:maydefer='true' rs:writeunknown='true' rs:basetable='tblMatchStage' rs:basecolumn='RemoveScoring'><s:datatype dt:type='boolean' dt:maxLength='2' rs:fixedlength='true'/></s:AttributeType><s:AttributeType name='TrgtPaper' rs:number='11' rs:nullable='true' rs:maydefer='true' rs:writeunknown='true' rs:basetable='tblMatchStage' rs:basecolumn='TrgtPaper'><s:datatype dt:type='ui1' dt:maxLength='1' rs:precision='3' rs:fixedlength='true'/></s:AttributeType><s:AttributeType name='TrgtPopper' rs:number='12' rs:nullable='true' rs:maydefer='true' rs:writeunknown='true' rs:basetable='tblMatchStage' rs:basecolumn='TrgtPopper'><s:datatype dt:type='ui1' dt:maxLength='1' rs:precision='3' rs:fixedlength='true'/></s:AttributeType><s:AttributeType name='TrgtPlates' rs:number='13' rs:nullable='true' rs:maydefer='true' rs:writeunknown='true' rs:basetable='tblMatchStage' rs:basecolumn='TrgtPlates'><s:datatype dt:type='ui1' dt:maxLength='1' rs:precision='3' rs:fixedlength='true'/></s:AttributeType><s:AttributeType name='TrgtVanish' rs:number='14' rs:nullable='true' rs:maydefer='true' rs:writeunknown='true' rs:basetable='tblMatchStage' rs:basecolumn='TrgtDisappear'><s:datatype dt:type='ui1' dt:maxLength='1' rs:precision='3' rs:fixedlength='true'/></s:AttributeType><s:AttributeType name='TrgtPenlty' rs:number='15' rs:nullable='true' rs:maydefer='true' rs:writeunknown='true' rs:basetable='tblMatchStage' rs:basecolumn='TrgtPenalty'><s:datatype dt:type='ui1' dt:maxLength='1' rs:precision='3' rs:fixedlength='true'/></s:AttributeType><s:AttributeType name='MinRounds' rs:number='16' rs:nullable='true' rs:maydefer='true' rs:writeunknown='true' rs:basetable='tblMatchStage' rs:basecolumn='MinRounds'><s:datatype dt:type='ui1' dt:maxLength='1' rs:precision='3' rs:fixedlength='true'/></s:AttributeType><s:AttributeType name='ReportOn' rs:number='17' rs:maydefer='true' rs:writeunknown='true' rs:basetable='tblMatchStage' rs:basecolumn='ReportOn'><s:datatype dt:type='boolean' dt:maxLength='2' rs:fixedlength='true'/></s:AttributeType><s:AttributeType name='MaxPoints' rs:number='18' rs:nullable='true' rs:maydefer='true' rs:writeunknown='true' rs:basetable='tblMatchStage' rs:basecolumn='MaxPoints'><s:datatype dt:type='i2' dt:maxLength='2' rs:precision='5' rs:fixedlength='true'/></s:AttributeType><s:AttributeType name='StartPos' rs:number='19' rs:nullable='true' rs:maydefer='true' rs:writeunknown='true' rs:basetable='tblMatchStage' rs:basecolumn='StartPosition'><s:datatype dt:type='string' dt:maxLength='536870910' rs:long='true'/></s:AttributeType><s:AttributeType name='StartOn' rs:number='20' rs:nullable='true' rs:maydefer='true' rs:writeunknown='true' rs:basetable='tblMatchStage' rs:basecolumn='StartOn'><s:datatype dt:type='string' dt:maxLength='8'/></s:AttributeType><s:AttributeType name='StringCnt' rs:number='21' rs:nullable='true' rs:maydefer='true' rs:writeunknown='true' rs:basetable='tblMatchStage' rs:basecolumn='StringsOfFire'><s:datatype dt:type='ui1' dt:maxLength='1' rs:precision='3' rs:fixedlength='true'/></s:AttributeType><s:AttributeType name='Descriptn' rs:number='22' rs:nullable='true' rs:maydefer='true' rs:writeunknown='true' rs:basetable='tblMatchStage' rs:basecolumn='Description'><s:datatype dt:type='string' dt:maxLength='536870910' rs:long='true'/></s:AttributeType><s:extends type='rs:rowbase'/></s:ElementType></s:Schema><rs:data><z:row MatchId='1' StageId='1' StageName='Stage 1 - Range 2' FirearmId='7' CourseId='1' ScoringId='1' TrgtTypeId='2' IcsStageId='0' Remove='False' TrgtPaper='5' TrgtPopper='2' TrgtPlates='0' TrgtVanish='0' TrgtPenlty='0' MinRounds='12' ReportOn='False' MaxPoints='60'/><z:row MatchId='1' StageId='2' StageName='Stage 2 - Range 4' FirearmId='7' CourseId='2' ScoringId='1' TrgtTypeId='2' IcsStageId='0' Remove='False' TrgtPaper='7' TrgtPopper='1' TrgtPlates='0' TrgtVanish='0' TrgtPenlty='0' MinRounds='15' ReportOn='False' MaxPoints='75'/><z:row MatchId='1' StageId='3' StageName='Stage 3 - Range 5' FirearmId='7' CourseId='3' ScoringId='1' TrgtTypeId='2' IcsStageId='0' Remove='False' TrgtPaper='13' TrgtPopper='0' TrgtPlates='0' TrgtVanish='0' TrgtPenlty='32' MinRounds='26' ReportOn='False' MaxPoints='130'/><z:row MatchId='1' StageId='4' StageName='Stage 4 - Range 7' FirearmId='7' CourseId='2' ScoringId='1' TrgtTypeId='2' IcsStageId='0' Remove='False' TrgtPaper='7' TrgtPopper='1' TrgtPlates='0' TrgtVanish='0' TrgtPenlty='0' MinRounds='15' ReportOn='False' MaxPoints='75'/><z:row MatchId='1' StageId='5' StageName='Stage 5 - Range 1' FirearmId='7' CourseId='1' ScoringId='1' TrgtTypeId='2' IcsStageId='0' Remove='False' TrgtPaper='6' TrgtPopper='0' TrgtPlates='0' TrgtVanish='0' TrgtPenlty='32' MinRounds='12' ReportOn='False' MaxPoints='60'/></rs:data></xml>",
                    "tag": "<xml xmlns:s='uuid:BDC6E3F0-6DA3-11d1-A2A3-00AA00C14882' xmlns:dt='uuid:C2F41010-65B3-11d1-A29F-00AA00C14882' xmlns:rs='urn:schemas-microsoft-com:rowset' xmlns:z='#RowsetSchema'><s:Schema id='RowsetSchema'><s:ElementType name='row' content='eltOnly' rs:updatable='true'><s:AttributeType name='TagId' rs:number='1' rs:maydefer='true' rs:writeunknown='true' rs:basetable='tblTag' rs:basecolumn='TagId' rs:keycolumn='true' rs:autoincrement='true'><s:datatype dt:type='int' dt:maxLength='4' rs:precision='10' rs:fixedlength='true'/></s:AttributeType><s:AttributeType name='Tag' rs:number='2' rs:nullable='true' rs:maydefer='true' rs:writeunknown='true' rs:basetable='tblTag' rs:basecolumn='Tag'><s:datatype dt:type='string' dt:maxLength='3'/></s:AttributeType><s:extends type='rs:rowbase'/></s:ElementType></s:Schema><rs:data><z:row TagId='1' Tag='RO'/></rs:data></xml>",
                    "member": "<xml xmlns:s='uuid:BDC6E3F0-6DA3-11d1-A2A3-00AA00C14882' xmlns:dt='uuid:C2F41010-65B3-11d1-A29F-00AA00C14882' xmlns:rs='urn:schemas-microsoft-com:rowset' xmlns:z='#RowsetSchema'><s:Schema id='RowsetSchema'><s:ElementType name='row' content='eltOnly' rs:updatable='true'><s:AttributeType name='MemberId' rs:number='1' rs:maydefer='true' rs:writeunknown='true' rs:basetable='tblMember' rs:basecolumn='MemberId' rs:keycolumn='true' rs:autoincrement='true'><s:datatype dt:type='int' dt:maxLength='4' rs:precision='10' rs:fixedlength='true'/></s:AttributeType><s:AttributeType name='Lastname' rs:number='2' rs:nullable='true' rs:maydefer='true' rs:writeunknown='true' rs:basetable='tblMember' rs:basecolumn='Lastname'><s:datatype dt:type='string' dt:maxLength='25'/></s:AttributeType><s:AttributeType name='Firstname' rs:number='3' rs:nullable='true' rs:maydefer='true' rs:writeunknown='true' rs:basetable='tblMember' rs:basecolumn='Firstname'><s:datatype dt:type='string' dt:maxLength='15'/></s:AttributeType><s:AttributeType name='Init' rs:number='4' rs:nullable='true' rs:maydefer='true' rs:writeunknown='true' rs:basetable='tblMember' rs:basecolumn='Comment'><s:datatype dt:type='string' dt:maxLength='1'/></s:AttributeType><s:AttributeType name='IcsAlias' rs:number='5' rs:nullable='true' rs:maydefer='true' rs:writeunknown='true' rs:basetable='tblMember' rs:basecolumn='ICS'><s:datatype dt:type='string' dt:maxLength='16'/></s:AttributeType><s:AttributeType name='RefNo' rs:number='6' rs:nullable='true' rs:maydefer='true' rs:writeunknown='true' rs:basetable='tblMember' rs:basecolumn='RefNo'><s:datatype dt:type='string' dt:maxLength='10'/></s:AttributeType><s:AttributeType name='InActive' rs:number='7' rs:maydefer='true' rs:writeunknown='true' rs:basetable='tblMember' rs:basecolumn='InActive'><s:datatype dt:type='boolean' dt:maxLength='2' rs:fixedlength='true'/></s:AttributeType><s:AttributeType name='Female' rs:number='8' rs:maydefer='true' rs:writeunknown='true' rs:basetable='tblMember' rs:basecolumn='Female'><s:datatype dt:type='boolean' dt:maxLength='2' rs:fixedlength='true'/></s:AttributeType><s:AttributeType name='PrintLabel' rs:number='9' rs:maydefer='true' rs:writeunknown='true' rs:basetable='tblMember' rs:basecolumn='PrintLabel'><s:datatype dt:type='boolean' dt:maxLength='2' rs:fixedlength='true'/></s:AttributeType><s:AttributeType name='RegionId' rs:number='10' rs:nullable='true' rs:maydefer='true' rs:writeunknown='true' rs:basetable='tblMember' rs:basecolumn='TypeRegionId'><s:datatype dt:type='string' dt:maxLength='3'/></s:AttributeType><s:AttributeType name='DOB' rs:number='11' rs:nullable='true' rs:maydefer='true' rs:writeunknown='true' rs:basetable='tblMember' rs:basecolumn='DOB'><s:datatype dt:type='dateTime' rs:dbtype='variantdate' dt:maxLength='16' rs:fixedlength='true'/></s:AttributeType><s:AttributeType name='Address1' rs:number='12' rs:nullable='true' rs:maydefer='true' rs:writeunknown='true' rs:basetable='tblMember' rs:basecolumn='Address1'><s:datatype dt:type='string' dt:maxLength='40'/></s:AttributeType><s:AttributeType name='Address2' rs:number='13' rs:nullable='true' rs:maydefer='true' rs:writeunknown='true' rs:basetable='tblMember' rs:basecolumn='Address2'><s:datatype dt:type='string' dt:maxLength='40'/></s:AttributeType><s:AttributeType name='City' rs:number='14' rs:nullable='true' rs:maydefer='true' rs:writeunknown='true' rs:basetable='tblMember' rs:basecolumn='City'><s:datatype dt:type='string' dt:maxLength='20'/></s:AttributeType><s:AttributeType name='Province' rs:number='15' rs:nullable='true' rs:maydefer='true' rs:writeunknown='true' rs:basetable='tblMember' rs:basecolumn='Province'><s:datatype dt:type='string' dt:maxLength='24'/></s:AttributeType><s:AttributeType name='CountryId' rs:number='16' rs:nullable='true' rs:maydefer='true' rs:writeunknown='true' rs:basetable='tblMember' rs:basecolumn='TypeCountryId'><s:datatype dt:type='string' dt:maxLength='3'/></s:AttributeType><s:AttributeType name='PostCode' rs:number='17' rs:nullable='true' rs:maydefer='true' rs:writeunknown='true' rs:basetable='tblMember' rs:basecolumn='PostCode'><s:datatype dt:type='string' dt:maxLength='10'/></s:AttributeType><s:AttributeType name='PhoneHome' rs:number='18' rs:nullable='true' rs:maydefer='true' rs:writeunknown='true' rs:basetable='tblMember' rs:basecolumn='PhoneHome'><s:datatype dt:type='string' dt:maxLength='20'/></s:AttributeType><s:AttributeType name='PhoneAlt' rs:number='19' rs:nullable='true' rs:maydefer='true' rs:writeunknown='true' rs:basetable='tblMember' rs:basecolumn='PhoneAlternate'><s:datatype dt:type='string' dt:maxLength='20'/></s:AttributeType><s:AttributeType name='PhoneFax' rs:number='20' rs:nullable='true' rs:maydefer='true' rs:writeunknown='true' rs:basetable='tblMember' rs:basecolumn='PhoneFax'><s:datatype dt:type='string' dt:maxLength='20'/></s:AttributeType><s:AttributeType name='Email' rs:number='21' rs:nullable='true' rs:maydefer='true' rs:writeunknown='true' rs:basetable='tblMember' rs:basecolumn='Email'><s:datatype dt:type='string' dt:maxLength='36'/></s:AttributeType><s:AttributeType name='ClassId' rs:number='22' rs:nullable='true' rs:maydefer='true' rs:writeunknown='true' rs:basetable='tblMember' rs:basecolumn='TypeScoreClassId'><s:datatype dt:type='string' dt:maxLength='1'/></s:AttributeType><s:AttributeType name='DfltDivId' rs:number='23' rs:nullable='true' rs:maydefer='true' rs:writeunknown='true' rs:basetable='tblMember' rs:basecolumn='DfltDivisionId'><s:datatype dt:type='ui1' dt:maxLength='1' rs:precision='3' rs:fixedlength='true'/></s:AttributeType><s:AttributeType name='DfltCatId' rs:number='24' rs:nullable='true' rs:maydefer='true' rs:writeunknown='true' rs:basetable='tblMember' rs:basecolumn='DfltNonTeamCategoryId'><s:datatype dt:type='ui1' dt:maxLength='1' rs:precision='3' rs:fixedlength='true'/></s:AttributeType><s:AttributeType name='DfltTagId' rs:number='25' rs:nullable='true' rs:maydefer='true' rs:writeunknown='true' rs:basetable='tblMember' rs:basecolumn='DfltTagId'><s:datatype dt:type='int' dt:maxLength='4' rs:precision='10' rs:fixedlength='true'/></s:AttributeType><s:AttributeType name='QualId' rs:number='26' rs:nullable='true' rs:maydefer='true' rs:writeunknown='true' rs:basetable='tblMember' rs:basecolumn='TypeQualificationId'><s:datatype dt:type='int' dt:maxLength='4' rs:precision='10' rs:fixedlength='true'/></s:AttributeType><s:AttributeType name='Register' rs:number='27' rs:maydefer='true' rs:writeunknown='true' rs:basetable='tblMember' rs:basecolumn='Register'><s:datatype dt:type='boolean' dt:maxLength='2' rs:fixedlength='true'/></s:AttributeType><s:AttributeType name='Note' rs:number='28' rs:nullable='true' rs:maydefer='true' rs:writeunknown='true' rs:basetable='tblMember' rs:basecolumn='Note'><s:datatype dt:type='string' dt:maxLength='536870910' rs:long='true'/></s:AttributeType><s:extends type='rs:rowbase'/></s:ElementType></s:Schema><rs:data><z:row MemberId='1' Lastname='van Rooyen' Firstname='JW' InActive='False' Female='false' PrintLabel='False' RegionId='CAN' Province='' ClassId='U' DfltDivId='0' DfltCatId='0' DfltTagId='0' QualId='0' IcsAlias='6800' Register='False'/><z:row MemberId='2' Lastname='van Rooyen' Firstname='Tristan' InActive='False' Female='false' PrintLabel='False' RegionId='CAN' Province='' ClassId='U' DfltDivId='0' DfltCatId='0' DfltTagId='0' QualId='0' IcsAlias='7305' Register='False'/><z:row MemberId='3' Lastname='Celliers' Firstname='JJ' InActive='False' Female='false' PrintLabel='False' RegionId='CAN' Province='' ClassId='U' DfltDivId='0' DfltCatId='0' DfltTagId='0' QualId='0' IcsAlias='7318' Register='False'/><z:row MemberId='4' Lastname='Meiring' Firstname='Wouter' InActive='False' Female='false' PrintLabel='False' RegionId='CAN' Province='' ClassId='U' DfltDivId='0' DfltCatId='0' DfltTagId='0' QualId='0' IcsAlias='3145' Register='False'/><z:row MemberId='5' Lastname='Basson' Firstname='Deon' InActive='False' Female='false' PrintLabel='False' RegionId='CAN' Province='' ClassId='U' DfltDivId='0' DfltCatId='0' DfltTagId='0' QualId='0' IcsAlias='6617' Register='False'/><z:row MemberId='6' Lastname='Van der Merwe' Firstname='Teeps' InActive='False' Female='false' PrintLabel='False' RegionId='CAN' Province='' ClassId='U' DfltDivId='0' DfltCatId='0' DfltTagId='0' QualId='0' IcsAlias='7131' Register='False'/><z:row MemberId='7' Lastname='Naude RO' Firstname='Ansley' InActive='False' Female='false' PrintLabel='False' RegionId='CAN' Province='' ClassId='U' DfltDivId='0' DfltCatId='0' DfltTagId='0' QualId='0' IcsAlias='5174' Register='False'/><z:row MemberId='8' Lastname='Greyling' Firstname='Reyner' InActive='False' Female='false' PrintLabel='False' RegionId='CAN' Province='' ClassId='U' DfltDivId='0' DfltCatId='0' DfltTagId='0' QualId='0' IcsAlias='7433' Register='False'/><z:row MemberId='9' Lastname='Meiring - Pistol' Firstname='Wouter' InActive='False' Female='false' PrintLabel='False' RegionId='CAN' Province='' ClassId='U' DfltDivId='0' DfltCatId='0' DfltTagId='0' QualId='0' IcsAlias='3145' Register='False'/><z:row MemberId='10' Lastname='van Herk' Firstname='Albert (RO)' InActive='False' Female='false' PrintLabel='False' RegionId='CAN' Province='' ClassId='U' DfltDivId='0' DfltCatId='0' DfltTagId='0' QualId='0' IcsAlias='352' Register='False'/><z:row MemberId='11' Lastname='Cruywagen' Firstname='Cruy (RO)' InActive='False' Female='false' PrintLabel='False' RegionId='CAN' Province='' ClassId='U' DfltDivId='0' DfltCatId='0' DfltTagId='0' QualId='0' IcsAlias='1485' Register='False'/><z:row MemberId='12' Lastname='Van der Merwe' Firstname='Hennie' InActive='False' Female='false' PrintLabel='False' RegionId='CAN' Province='' ClassId='U' DfltDivId='0' DfltCatId='0' DfltTagId='0' QualId='0' IcsAlias='10243' Register='False'/><z:row MemberId='13' Lastname='van der Merwe' Firstname='Hester' InActive='False' Female='false' PrintLabel='False' RegionId='CAN' Province='' ClassId='U' DfltDivId='0' DfltCatId='0' DfltTagId='0' QualId='0' IcsAlias='10257' Register='False'/><z:row MemberId='14' Lastname='Lubbe' Firstname='Phil' InActive='False' Female='false' PrintLabel='False' RegionId='CAN' Province='' ClassId='U' DfltDivId='0' DfltCatId='0' DfltTagId='0' QualId='0' IcsAlias='15000' Register='False'/><z:row MemberId='15' Lastname='Meiring' Firstname='Charl' InActive='False' Female='false' PrintLabel='False' RegionId='CAN' Province='' ClassId='U' DfltDivId='0' DfltCatId='0' DfltTagId='0' QualId='0' IcsAlias='177' Register='False'/><z:row MemberId='16' Lastname='Celliers' Firstname='JJ' InActive='False' Female='false' PrintLabel='False' RegionId='CAN' Province='' ClassId='U' DfltDivId='0' DfltCatId='0' DfltTagId='0' QualId='0' IcsAlias='7318' Register='False'/><z:row MemberId='17' Lastname='Naude RO2' Firstname='Ansley' InActive='False' Female='false' PrintLabel='False' RegionId='CAN' Province='' ClassId='U' DfltDivId='0' DfltCatId='0' DfltTagId='0' QualId='0' IcsAlias='5174' Register='False'/><z:row MemberId='18' Lastname='Senekal' Firstname='Sonja' InActive='False' Female='false' PrintLabel='False' RegionId='CAN' Province='' ClassId='U' DfltDivId='0' DfltCatId='0' DfltTagId='0' QualId='0' IcsAlias='5779' Register='False'/><z:row MemberId='19' Lastname='Struwig' Firstname='Alicia' InActive='False' Female='false' PrintLabel='False' RegionId='CAN' Province='' ClassId='U' DfltDivId='0' DfltCatId='0' DfltTagId='0' QualId='0' IcsAlias='6828' Register='False'/><z:row MemberId='20' Lastname='Roos' Firstname='Riaan' InActive='False' Female='false' PrintLabel='False' RegionId='CAN' Province='' ClassId='U' DfltDivId='0' DfltCatId='0' DfltTagId='0' QualId='0' IcsAlias='6863' Register='False'/><z:row MemberId='21' Lastname='Visser' Firstname='Neil (RO)' InActive='False' Female='false' PrintLabel='False' RegionId='CAN' Province='' ClassId='U' DfltDivId='0' DfltCatId='0' DfltTagId='0' QualId='0' IcsAlias='7756' Register='False'/><z:row MemberId='22' Lastname='Van Eck' Firstname='Yolande' InActive='False' Female='true' PrintLabel='False' RegionId='CAN' Province='' ClassId='U' DfltDivId='0' DfltCatId='0' DfltTagId='0' QualId='0' IcsAlias='7910' Register='False'/><z:row MemberId='23' Lastname='Taylor' Firstname='Neil' InActive='False' Female='false' PrintLabel='False' RegionId='CAN' Province='' ClassId='U' DfltDivId='0' DfltCatId='0' DfltTagId='0' QualId='0' IcsAlias='6238' Register='False'/><z:row MemberId='24' Lastname='Taylor' Firstname='Neil (RO)' InActive='False' Female='false' PrintLabel='False' RegionId='CAN' Province='' ClassId='U' DfltDivId='0' DfltCatId='0' DfltTagId='0' QualId='0' IcsAlias='6238' Register='False'/><z:row MemberId='25' Lastname='Moloko' Firstname='Makgalema Absalom' InActive='False' Female='false' PrintLabel='False' RegionId='CAN' Province='' ClassId='U' DfltDivId='0' DfltCatId='0' DfltTagId='0' QualId='0' IcsAlias='15000' Register='False'/><z:row MemberId='26' Lastname='Kemp' Firstname='Daan' InActive='False' Female='false' PrintLabel='False' RegionId='CAN' Province='' ClassId='U' DfltDivId='0' DfltCatId='0' DfltTagId='0' QualId='0' IcsAlias='71' Register='False'/><z:row MemberId='27' Lastname='Spencer' Firstname='Terry' InActive='False' Female='false' PrintLabel='False' RegionId='CAN' Province='' ClassId='U' DfltDivId='0' DfltCatId='0' DfltTagId='0' QualId='0' IcsAlias='7156' Register='False'/><z:row MemberId='28' Lastname='Spencer' Firstname='Terri' InActive='False' Female='false' PrintLabel='False' RegionId='CAN' Province='' ClassId='U' DfltDivId='0' DfltCatId='0' DfltTagId='0' QualId='0' IcsAlias='7156' Register='False'/><z:row MemberId='29' Lastname='Koekemoer' Firstname='Francois' InActive='False' Female='false' PrintLabel='False' RegionId='CAN' Province='' ClassId='U' DfltDivId='0' DfltCatId='0' DfltTagId='0' QualId='0' IcsAlias='6434' Register='False'/><z:row MemberId='30' Lastname='Gloster' Firstname='John (RO)' InActive='False' Female='false' PrintLabel='False' RegionId='CAN' Province='' ClassId='U' DfltDivId='0' DfltCatId='0' DfltTagId='0' QualId='0' IcsAlias='4603' Register='False'/><z:row MemberId='31' Lastname='Casey' Firstname='James' InActive='False' Female='false' PrintLabel='False' RegionId='CAN' Province='' ClassId='U' DfltDivId='0' DfltCatId='0' DfltTagId='0' QualId='0' IcsAlias='7432' Register='False'/><z:row MemberId='32' Lastname='Koch' Firstname='Brendon' InActive='False' Female='false' PrintLabel='False' RegionId='CAN' Province='' ClassId='U' DfltDivId='0' DfltCatId='0' DfltTagId='0' QualId='0' IcsAlias='2362' Register='False'/><z:row MemberId='33' Lastname='Oxford-May' Firstname='Juanita' InActive='False' Female='true' PrintLabel='False' RegionId='CAN' Province='' ClassId='U' DfltDivId='0' DfltCatId='0' DfltTagId='0' QualId='0' IcsAlias='4961' Register='False'/><z:row MemberId='34' Lastname='Pretorius' Firstname='Tinus' InActive='False' Female='false' PrintLabel='False' RegionId='CAN' Province='' ClassId='U' DfltDivId='0' DfltCatId='0' DfltTagId='0' QualId='0' IcsAlias='5030' Register='False'/><z:row MemberId='35' Lastname='Egleton RO' Firstname='Billy' InActive='False' Female='false' PrintLabel='False' RegionId='CAN' Province='' ClassId='U' DfltDivId='0' DfltCatId='0' DfltTagId='0' QualId='0' IcsAlias='620' Register='False'/><z:row MemberId='36' Lastname='Basson' Firstname='Frik' InActive='False' Female='false' PrintLabel='False' RegionId='CAN' Province='' ClassId='U' DfltDivId='0' DfltCatId='0' DfltTagId='0' QualId='0' IcsAlias='2376' Register='False'/><z:row MemberId='37' Lastname='Lubbinge' Firstname='Engela' InActive='False' Female='true' PrintLabel='False' RegionId='CAN' Province='' ClassId='U' DfltDivId='0' DfltCatId='0' DfltTagId='0' QualId='0' IcsAlias='3480' Register='False'/><z:row MemberId='38' Lastname='Janse van Rensburg' Firstname='Marvick' InActive='False' Female='false' PrintLabel='False' RegionId='CAN' Province='' ClassId='U' DfltDivId='0' DfltCatId='0' DfltTagId='0' QualId='0' IcsAlias='3257' Register='False'/><z:row MemberId='39' Lastname='Wiesener' Firstname='Shandre' InActive='False' Female='false' PrintLabel='False' RegionId='CAN' Province='' ClassId='U' DfltDivId='0' DfltCatId='0' DfltTagId='0' QualId='0' IcsAlias='10142' Register='False'/><z:row MemberId='40' Lastname='Wiesener' Firstname='Wilfried' InActive='False' Female='false' PrintLabel='False' RegionId='CAN' Province='' ClassId='U' DfltDivId='0' DfltCatId='0' DfltTagId='0' QualId='0' IcsAlias='10141' Register='False'/><z:row MemberId='41' Lastname='Barkhuizen' Firstname='Tom' InActive='False' Female='false' PrintLabel='False' RegionId='CAN' Province='' ClassId='U' DfltDivId='0' DfltCatId='0' DfltTagId='0' QualId='0' IcsAlias='566' Register='False'/><z:row MemberId='42' Lastname='Bothma' Firstname='Basie' InActive='False' Female='false' PrintLabel='False' RegionId='CAN' Province='' ClassId='U' DfltDivId='0' DfltCatId='0' DfltTagId='0' QualId='0' IcsAlias='2353' Register='False'/><z:row MemberId='43' Lastname='Smit' Firstname='Sarel' InActive='False' Female='false' PrintLabel='False' RegionId='CAN' Province='' ClassId='U' DfltDivId='0' DfltCatId='0' DfltTagId='0' QualId='0' IcsAlias='1082' Register='False'/><z:row MemberId='44' Lastname='Bothma' Firstname='Leeor' InActive='False' Female='false' PrintLabel='False' RegionId='CAN' Province='' ClassId='U' DfltDivId='0' DfltCatId='0' DfltTagId='0' QualId='0' IcsAlias='4090' Register='False'/><z:row MemberId='45' Lastname='Steenkamp' Firstname='Amor' InActive='False' Female='false' PrintLabel='False' RegionId='CAN' Province='' ClassId='U' DfltDivId='0' DfltCatId='0' DfltTagId='0' QualId='0' IcsAlias='15000' Register='False'/><z:row MemberId='46' Lastname='Roodt' Firstname='JL' InActive='False' Female='false' PrintLabel='False' RegionId='CAN' Province='' ClassId='U' DfltDivId='0' DfltCatId='0' DfltTagId='0' QualId='0' IcsAlias='2412' Register='False'/><z:row MemberId='47' Lastname='Sutherland' Firstname='Shaun' InActive='False' Female='false' PrintLabel='False' RegionId='CAN' Province='' ClassId='U' DfltDivId='0' DfltCatId='0' DfltTagId='0' QualId='0' IcsAlias='15000' Register='False'/><z:row MemberId='48' Lastname='Meintjes' Firstname='Hannes' InActive='False' Female='false' PrintLabel='False' RegionId='CAN' Province='' ClassId='U' DfltDivId='0' DfltCatId='0' DfltTagId='0' QualId='0' IcsAlias='134' Register='False'/><z:row MemberId='49' Lastname='viljoen' Firstname='johan' InActive='False' Female='false' PrintLabel='False' RegionId='CAN' Province='' ClassId='U' DfltDivId='0' DfltCatId='0' DfltTagId='0' QualId='0' IcsAlias='403' Register='False'/><z:row MemberId='50' Lastname='Lubbinge' Firstname='Jan (RO)' InActive='False' Female='false' PrintLabel='False' RegionId='CAN' Province='' ClassId='U' DfltDivId='0' DfltCatId='0' DfltTagId='0' QualId='0' IcsAlias='15000' Register='False'/><z:row MemberId='51' Lastname='Lubbinge' Firstname='Leoni' InActive='False' Female='false' PrintLabel='False' RegionId='CAN' Province='' ClassId='U' DfltDivId='0' DfltCatId='0' DfltTagId='0' QualId='0' IcsAlias='15000' Register='False'/><z:row MemberId='52' Lastname='Clack' Firstname='Tyler' InActive='False' Female='false' PrintLabel='False' RegionId='CAN' Province='' ClassId='U' DfltDivId='0' DfltCatId='0' DfltTagId='0' QualId='0' IcsAlias='15000' Register='False'/><z:row MemberId='53' Lastname='Oelofse' Firstname='Hennie' InActive='False' Female='false' PrintLabel='False' RegionId='CAN' Province='' ClassId='U' DfltDivId='0' DfltCatId='0' DfltTagId='0' QualId='0' IcsAlias='6650' Register='False'/><z:row MemberId='54' Lastname='Carstens' Firstname='Frederick' InActive='False' Female='false' PrintLabel='False' RegionId='CAN' Province='' ClassId='U' DfltDivId='0' DfltCatId='0' DfltTagId='0' QualId='0' IcsAlias='15000' Register='False'/><z:row MemberId='55' Lastname='Freddy' Firstname='Tebogo' InActive='False' Female='false' PrintLabel='False' RegionId='CAN' Province='' ClassId='U' DfltDivId='0' DfltCatId='0' DfltTagId='0' QualId='0' IcsAlias='01015312' Register='False'/><z:row MemberId='56' Lastname='MOGANO' Firstname='Freddy' InActive='False' Female='false' PrintLabel='False' RegionId='CAN' Province='' ClassId='U' DfltDivId='0' DfltCatId='0' DfltTagId='0' QualId='0' IcsAlias='01015312' Register='False'/><z:row MemberId='57' Lastname='Cloete' Firstname='Steven' InActive='False' Female='false' PrintLabel='False' RegionId='CAN' Province='' ClassId='U' DfltDivId='0' DfltCatId='0' DfltTagId='0' QualId='0' IcsAlias='6458' Register='False'/><z:row MemberId='58' Lastname='Swart' Firstname='Deon (RO)' InActive='False' Female='false' PrintLabel='False' RegionId='CAN' Province='' ClassId='U' DfltDivId='0' DfltCatId='0' DfltTagId='0' QualId='0' IcsAlias='6250' Register='False'/><z:row MemberId='59' Lastname='Combrink' Firstname='Herman' InActive='False' Female='false' PrintLabel='False' RegionId='CAN' Province='' ClassId='U' DfltDivId='0' DfltCatId='0' DfltTagId='0' QualId='0' IcsAlias='4995' Register='False'/><z:row MemberId='60' Lastname='Botha' Firstname='Willie' InActive='False' Female='false' PrintLabel='False' RegionId='CAN' Province='' ClassId='U' DfltDivId='0' DfltCatId='0' DfltTagId='0' QualId='0' IcsAlias='1522' Register='False'/><z:row MemberId='61' Lastname='van der Walt' Firstname='James' InActive='False' Female='false' PrintLabel='False' RegionId='CAN' Province='' ClassId='U' DfltDivId='0' DfltCatId='0' DfltTagId='0' QualId='0' IcsAlias='15000' Register='False'/><z:row MemberId='62' Lastname='Goosen' Firstname='Wilnes' InActive='False' Female='false' PrintLabel='False' RegionId='CAN' Province='' ClassId='U' DfltDivId='0' DfltCatId='0' DfltTagId='0' QualId='0' IcsAlias='N/A' Register='False'/><z:row MemberId='63' Lastname='Mojakgolo' Firstname='Thuso' InActive='False' Female='false' PrintLabel='False' RegionId='CAN' Province='' ClassId='U' DfltDivId='0' DfltCatId='0' DfltTagId='0' QualId='0' IcsAlias='97005631' Register='False'/><z:row MemberId='64' Lastname='Shoobert' Firstname='Bradley' InActive='False' Female='false' PrintLabel='False' RegionId='CAN' Province='' ClassId='U' DfltDivId='0' DfltCatId='0' DfltTagId='0' QualId='0' IcsAlias='15000' Register='False'/><z:row MemberId='65' Lastname='Malan' Firstname='Johan' InActive='False' Female='false' PrintLabel='False' RegionId='CAN' Province='' ClassId='U' DfltDivId='0' DfltCatId='0' DfltTagId='0' QualId='0' IcsAlias='7726' Register='False'/><z:row MemberId='66' Lastname='Rampershad' Firstname='Nilan' InActive='False' Female='false' PrintLabel='False' RegionId='CAN' Province='' ClassId='U' DfltDivId='0' DfltCatId='0' DfltTagId='0' QualId='0' IcsAlias='2049' Register='False'/><z:row MemberId='67' Lastname='mokolo' Firstname='Moses' InActive='False' Female='false' PrintLabel='False' RegionId='CAN' Province='' ClassId='U' DfltDivId='0' DfltCatId='0' DfltTagId='0' QualId='0' IcsAlias='15000' Register='False'/><z:row MemberId='68' Lastname='Prinsloo' Firstname='Joggie' InActive='False' Female='false' PrintLabel='False' RegionId='CAN' Province='' ClassId='U' DfltDivId='0' DfltCatId='0' DfltTagId='0' QualId='0' IcsAlias='251' Register='False'/><z:row MemberId='69' Lastname='Boshoff' Firstname='Marelize' InActive='False' Female='true' PrintLabel='False' RegionId='CAN' Province='' ClassId='U' DfltDivId='0' DfltCatId='0' DfltTagId='0' QualId='0' IcsAlias='6694' Register='False'/><z:row MemberId='70' Lastname='Venter' Firstname='Dirk' InActive='False' Female='false' PrintLabel='False' RegionId='CAN' Province='' ClassId='U' DfltDivId='0' DfltCatId='0' DfltTagId='0' QualId='0' IcsAlias='6694' Register='False'/><z:row MemberId='71' Lastname='Putter' Firstname='Lourens' InActive='False' Female='false' PrintLabel='False' RegionId='CAN' Province='' ClassId='U' DfltDivId='0' DfltCatId='0' DfltTagId='0' QualId='0' IcsAlias='15000' Register='False'/><z:row MemberId='72' Lastname='Van Wyk' Firstname='Dawid' InActive='False' Female='false' PrintLabel='False' RegionId='CAN' Province='' ClassId='U' DfltDivId='0' DfltCatId='0' DfltTagId='0' QualId='0' IcsAlias='90489147' Register='False'/><z:row MemberId='73' Lastname='Venter' Firstname='Jan' InActive='False' Female='false' PrintLabel='False' RegionId='CAN' Province='' ClassId='U' DfltDivId='0' DfltCatId='0' DfltTagId='0' QualId='0' IcsAlias='5265' Register='False'/><z:row MemberId='74' Lastname='Barnes' Firstname='Heinrich' InActive='False' Female='false' PrintLabel='False' RegionId='CAN' Province='' ClassId='U' DfltDivId='0' DfltCatId='0' DfltTagId='0' QualId='0' IcsAlias='6833' Register='False'/><z:row MemberId='75' Lastname='Farrell' Firstname='Adrian' InActive='False' Female='false' PrintLabel='False' RegionId='CAN' Province='' ClassId='U' DfltDivId='0' DfltCatId='0' DfltTagId='0' QualId='0' IcsAlias='7200' Register='False'/><z:row MemberId='76' Lastname='Farrell' Firstname='Chevonne' InActive='False' Female='true' PrintLabel='False' RegionId='CAN' Province='' ClassId='U' DfltDivId='0' DfltCatId='0' DfltTagId='0' QualId='0' IcsAlias='15000' Register='False'/><z:row MemberId='77' Lastname='Modiba' Firstname='Richard' InActive='False' Female='false' PrintLabel='False' RegionId='CAN' Province='' ClassId='U' DfltDivId='0' DfltCatId='0' DfltTagId='0' QualId='0' IcsAlias='15000' Register='False'/><z:row MemberId='78' Lastname='Eicker' Firstname='Albert' InActive='False' Female='false' PrintLabel='False' RegionId='CAN' Province='' ClassId='U' DfltDivId='0' DfltCatId='0' DfltTagId='0' QualId='0' IcsAlias='5173' Register='False'/><z:row MemberId='79' Lastname='Diefo' Firstname='Motlatsi Victor' InActive='False' Female='false' PrintLabel='False' RegionId='CAN' Province='' ClassId='U' DfltDivId='0' DfltCatId='0' DfltTagId='0' QualId='0' IcsAlias='15000' Register='False'/><z:row MemberId='80' Lastname='Hecht' Firstname='Mariette' InActive='False' Female='false' PrintLabel='False' RegionId='CAN' Province='' ClassId='U' DfltDivId='0' DfltCatId='0' DfltTagId='0' QualId='0' IcsAlias='5330' Register='False'/><z:row MemberId='81' Lastname='Celliers' Firstname='JJ' InActive='False' Female='false' PrintLabel='False' RegionId='CAN' Province='' ClassId='U' DfltDivId='0' DfltCatId='0' DfltTagId='0' QualId='0' IcsAlias='7318' Register='False'/><z:row MemberId='82' Lastname='Hlengwa' Firstname='Vela' InActive='False' Female='false' PrintLabel='False' RegionId='CAN' Province='' ClassId='U' DfltDivId='0' DfltCatId='0' DfltTagId='0' QualId='0' IcsAlias='15000' Register='False'/><z:row MemberId='83' Lastname='Smit' Firstname='Tiaan' InActive='False' Female='false' PrintLabel='False' RegionId='CAN' Province='' ClassId='U' DfltDivId='0' DfltCatId='0' DfltTagId='0' QualId='0' IcsAlias='5998' Register='False'/><z:row MemberId='84' Lastname='Lubbe' Firstname='Marcel' InActive='False' Female='false' PrintLabel='False' RegionId='CAN' Province='' ClassId='U' DfltDivId='0' DfltCatId='0' DfltTagId='0' QualId='0' IcsAlias='15000' Register='False'/><z:row MemberId='85' Lastname='Zhang' Firstname='Dan' InActive='False' Female='false' PrintLabel='False' RegionId='CAN' Province='' ClassId='U' DfltDivId='0' DfltCatId='0' DfltTagId='0' QualId='0' IcsAlias='7486' Register='False'/><z:row MemberId='86' Lastname='Jager' Firstname='Garth' InActive='False' Female='false' PrintLabel='False' RegionId='CAN' Province='' ClassId='U' DfltDivId='0' DfltCatId='0' DfltTagId='0' QualId='0' IcsAlias='15000' Register='False'/><z:row MemberId='87' Lastname='Losper' Firstname='Monique' InActive='False' Female='true' PrintLabel='False' RegionId='CAN' Province='' ClassId='U' DfltDivId='0' DfltCatId='0' DfltTagId='0' QualId='0' IcsAlias='15000' Register='False'/><z:row MemberId='88' Lastname='Du Preez' Firstname='Jean' InActive='False' Female='false' PrintLabel='False' RegionId='CAN' Province='' ClassId='U' DfltDivId='0' DfltCatId='0' DfltTagId='0' QualId='0' IcsAlias='6857' Register='False'/><z:row MemberId='89' Lastname='van Heerden' Firstname='Gidion C' InActive='False' Female='false' PrintLabel='False' RegionId='CAN' Province='' ClassId='U' DfltDivId='0' DfltCatId='0' DfltTagId='0' QualId='0' IcsAlias='2366' Register='False'/><z:row MemberId='90' Lastname='Myburgh' Firstname='Adam' InActive='False' Female='false' PrintLabel='False' RegionId='CAN' Province='' ClassId='U' DfltDivId='0' DfltCatId='0' DfltTagId='0' QualId='0' IcsAlias='15000' Register='False'/><z:row MemberId='91' Lastname='Page (Nita)' Firstname='Janita' InActive='False' Female='true' PrintLabel='False' RegionId='CAN' Province='' ClassId='U' DfltDivId='0' DfltCatId='0' DfltTagId='0' QualId='0' IcsAlias='7179' Register='False'/><z:row MemberId='92' Lastname='Page' Firstname='Jorncy' InActive='False' Female='false' PrintLabel='False' RegionId='CAN' Province='' ClassId='U' DfltDivId='0' DfltCatId='0' DfltTagId='0' QualId='0' IcsAlias='7179' Register='False'/><z:row MemberId='93' Lastname='van Zyl' Firstname='Rouleaux' InActive='False' Female='false' PrintLabel='False' RegionId='CAN' Province='' ClassId='U' DfltDivId='0' DfltCatId='0' DfltTagId='0' QualId='0' IcsAlias='01058379MC' Register='False'/><z:row MemberId='94' Lastname='Naude' Firstname='Kaitlyn' InActive='False' Female='true' PrintLabel='False' RegionId='CAN' Province='' ClassId='U' DfltDivId='0' DfltCatId='0' DfltTagId='0' QualId='0' IcsAlias='1975' Register='False'/><z:row MemberId='95' Lastname='Badenhorst' Firstname='Theo' InActive='False' Female='false' PrintLabel='False' RegionId='CAN' Province='' ClassId='U' DfltDivId='0' DfltCatId='0' DfltTagId='0' QualId='0' IcsAlias='6654' Register='False'/><z:row MemberId='96' Lastname='Brummer' Firstname='Marie' InActive='False' Female='true' PrintLabel='False' RegionId='CAN' Province='' ClassId='U' DfltDivId='0' DfltCatId='0' DfltTagId='0' QualId='0' IcsAlias='7099' Register='False'/><z:row MemberId='97' Lastname='Du Preez' Firstname='Ray' InActive='False' Female='false' PrintLabel='False' RegionId='CAN' Province='' ClassId='U' DfltDivId='0' DfltCatId='0' DfltTagId='0' QualId='0' IcsAlias='2862' Register='False'/><z:row MemberId='98' Lastname='Myburgh' Firstname='Fred' InActive='False' Female='false' PrintLabel='False' RegionId='CAN' Province='' ClassId='U' DfltDivId='0' DfltCatId='0' DfltTagId='0' QualId='0' IcsAlias='16000' Register='False'/><z:row MemberId='99' Lastname='Wanda' Firstname='Zama' InActive='False' Female='false' PrintLabel='False' RegionId='CAN' Province='' ClassId='U' DfltDivId='0' DfltCatId='0' DfltTagId='0' QualId='0' IcsAlias='398' Register='False'/></rs:data></xml>",
                    "classify": "<xml xmlns:s='uuid:BDC6E3F0-6DA3-11d1-A2A3-00AA00C14882' xmlns:dt='uuid:C2F41010-65B3-11d1-A29F-00AA00C14882' xmlns:rs='urn:schemas-microsoft-com:rowset' xmlns:z='#RowsetSchema'><s:Schema id='RowsetSchema'><s:ElementType name='row' content='eltOnly' rs:updatable='true'><s:AttributeType name='MemberId' rs:number='1' rs:maydefer='true' rs:writeunknown='true' rs:basetable='tblMemberClassify' rs:basecolumn='MemberId' rs:keycolumn='true'><s:datatype dt:type='int' dt:maxLength='4' rs:precision='10' rs:fixedlength='true'/></s:AttributeType><s:AttributeType name='DivId' rs:number='2' rs:maydefer='true' rs:writeunknown='true' rs:basetable='tblMemberClassify' rs:basecolumn='TypeDivisionId' rs:keycolumn='true'><s:datatype dt:type='ui1' dt:maxLength='1' rs:precision='3' rs:fixedlength='true'/></s:AttributeType><s:AttributeType name='IntlId' rs:number='3' rs:maydefer='true' rs:writeunknown='true' rs:basetable='tblMemberClassify' rs:basecolumn='TypeClassIntlId'><s:datatype dt:type='string' dt:maxLength='1'/></s:AttributeType><s:AttributeType name='NatlId' rs:number='4' rs:maydefer='true' rs:writeunknown='true' rs:basetable='tblMemberClassify' rs:basecolumn='TypeClassNatlId'><s:datatype dt:type='string' dt:maxLength='1'/></s:AttributeType><s:AttributeType name='ClassId' rs:number='5' rs:nullable='true' rs:maydefer='true' rs:writeunknown='true' rs:basetable='tblMemberClassify' rs:basecolumn='TypeScoreClassId'><s:datatype dt:type='string' dt:maxLength='1'/></s:AttributeType><s:extends type='rs:rowbase'/></s:ElementType></s:Schema><rs:data/></xml>"
                }
                """;

        IpscMatchRecordHolder ipscMatchRecordHolder = assertDoesNotThrow(() ->
                ipscService.importWinMssCabFile(cabFileContent));
        assertNotNull(ipscMatchRecordHolder);
        assertNotNull(ipscMatchRecordHolder.matches());
        assertEquals(1, ipscMatchRecordHolder.matches().size());

        IpscMatchRecord ipscMatchRecord = ipscMatchRecordHolder.matches().getFirst();
        assertEquals("", ipscMatchRecord.clubName());
        assertEquals("Eeufees HG and PCC Club Shoot February 2026", ipscMatchRecord.name());
        assertEquals("Club Shoot", ipscMatchRecord.matchCategory());
        assertEquals("PCC", ipscMatchRecord.matchFirearmType());
        assertEquals("2026-02-07", ipscMatchRecord.scheduledDate());
        assertNotNull(ipscMatchRecord.dateEdited());
    }
}
